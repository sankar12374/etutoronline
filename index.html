<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>E-Tutor Login Page</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
</head>
<body>
  <div class="container">
    <div class="login-box student">
      <h2>Student Login</h2>
      <input type="text" id="student-email" placeholder="Email" required class="input-box">
      <input type="password" id="student-password" placeholder="Password" required class="input-box">
      <button class="input-box" onclick="studentLogin()">Login</button>
      <p class="register">Not registered? <a href="studentregister.html">Please register here</a></p>
    </div>
    <div class="login-box faculty">
      <h2>Faculty Login</h2>
      <input type="text" id="faculty-email" placeholder="Email" required class="input-box">
      <input type="password" id="faculty-password" placeholder="Password" required class="input-box">
      <button class="input-box" onclick="facultyLogin()">Login</button>
      <p class="register">Not registered? <a href="faculty-register.html">Please register here</a></p>
    </div>
  </div>
  <div class="e-tutor pen">üñäÔ∏è</div>
  <div class="e-tutor pencil">‚úèÔ∏è</div>

  <script>
    const supabaseUrl = 'https://ifztgewdgcfxppsocsco.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlmenRnZXdkZ2NmeHBwc29jc2NvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA3OTY0MTAsImV4cCI6MjA1NjM3MjQxMH0.I8zh1pagpB7ZnXiVWvYQ0rUBqqnWtqBb4GaN4Bubw0w';
   
    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

    async function studentLogin() {
      const email = document.getElementById('student-email').value;
      const password = document.getElementById('student-password').value;

      try {
        const { data, error } = await supabase.auth.signInWithPassword({ 
          email, 
          password,
          options: {
            data: {
              user_type: 'student'
            }
          }
        });

        if (error) throw error;
        
        alert('Student login successful!');
        window.location.href = 'student-dashboard.html';
      } catch (error) {
        alert('Login failed: ' + error.message);
      }
    }

    async function facultyLogin() {
      const email = document.getElementById('faculty-email').value;
      const password = document.getElementById('faculty-password').value;

      try {
        const { data, error } = await supabase.auth.signInWithPassword({ 
          email, 
          password,
          options: {
            data: {
              user_type: 'faculty'
            }
          }
        });

        if (error) throw error;
        
        // Verify user metadata contains faculty type
        const { data: { user } } = await supabase.auth.getUser();
        if (user.user_metadata?.user_type !== 'faculty') {
          await supabase.auth.signOut();
          throw new Error('Faculty access only');
        }

        alert('Faculty login successful!');
        window.location.href = 'faculty-dashboard.html';
      } catch (error) {
        alert('Faculty login failed: ' + error.message);
      }
    }
  </script>
</body>
</html>
